<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Snake Game</title>
<style>
  canvas { background: #111; display: block; margin: 20px auto; border: 3px solid #333; }
  #leaderboard { display: none; text-align: center; color: white; }
  #controls { text-align: center; margin-top: 20px; }
  button { margin: 5px; padding: 5px 10px; cursor: pointer; }
  body { background: #222; color: white; font-family: Arial, sans-serif; }
</style>
</head>
<body>

<div id="controls">
  Name: <input type="text" id="playerName">
  <button onclick="startGame()">Start Game</button>
</div>

<canvas id="gameCanvas" width="400" height="400"></canvas>

<div id="leaderboard">
  <h2>Leaderboard</h2>
  <ul id="scoresList"></ul>
  <button onclick="restartGame()">Back to Game</button>
</div>

<audio id="eatSound" src="https://www.soundjay.com/button/beep-07.mp3"></audio>
<audio id="gameOverSound" src="https://www.soundjay.com/button/beep-10.mp3"></audio>

<script>
const canvas = document.getElementById("gameCanvas");
const ctx = canvas.getContext("2d");

let snake = [{x:200, y:200}];
let dx = 20, dy = 0;
let food = {x:0, y:0};
let score = 0;
let gameInterval;
let currentUser;
let isAdmin = false;

// Fixed admin password
const ADMIN_PASSWORD = "0108";

// Sounds
const eatSound = document.getElementById("eatSound");
const gameOverSound = document.getElementById("gameOverSound");

// Start game
function startGame() {
  const name = document.getElementById("playerName").value.trim();
  if(!name) { alert("Enter your name!"); return; }
  currentUser = name;

  if(name === "Rudra") {
    handleAdminLogin();
  } else {
    isAdmin = false;
    initGame();
  }
}

// Admin password input
function handleAdminLogin() {
  let pass = prompt("Enter admin password:");
  if(pass === ADMIN_PASSWORD) {
    alert("Welcome admin!");
    isAdmin = true;
  } else {
    alert("Wrong password! Playing as normal player.");
    isAdmin = false;
  }
  initGame();
}

// Initialize game
function initGame() {
  snake = [{x:200, y:200}];
  dx = 20; dy = 0; score = 0;
  placeFood();
  document.getElementById("controls").style.display = "none";
  canvas.style.display = "block";
  document.getElementById("leaderboard").style.display = "none";
  if(gameInterval) clearInterval(gameInterval);
  gameInterval = setInterval(gameLoop, 150); // slow speed
}

// Place food randomly
function placeFood() {
  food.x = Math.floor(Math.random()*20)*20;
  food.y = Math.floor(Math.random()*20)*20;
}

// Game loop
function gameLoop() {
  const head = {x: snake[0].x + dx, y: snake[0].y + dy};
  
  // Collision check
  if(head.x < 0 || head.x >= canvas.width || head.y < 0 || head.y >= canvas.height || snake.some(s => s.x === head.x && s.y === head.y)) {
    clearInterval(gameInterval);
    gameOverSound.play();
    saveScore();
    showLeaderboard();
    return;
  }

  snake.unshift(head);
  if(head.x === food.x && head.y === food.y) {
    score += 10;
    eatSound.play();
    placeFood();
  } else {
    snake.pop();
  }

  drawGame();
}

// Draw snake & food
function drawGame() {
  ctx.clearRect(0,0,canvas.width,canvas.height);

  // Draw food
  ctx.fillStyle = "yellow";
  ctx.beginPath();
  ctx.arc(food.x+10, food.y+10, 10, 0, Math.PI*2);
  ctx.fill();

  // Draw snake with colorful segments
  snake.forEach((s,i)=>{
    ctx.fillStyle = `hsl(${(i*30)%360}, 100%, 50%)`;
    ctx.fillRect(s.x, s.y, 20, 20);
  });
}

// Handle arrow keys
document.addEventListener("keydown", e => {
  switch(e.key) {
    case "ArrowUp": if(dy===0){dx=0; dy=-20;} break;
    case "ArrowDown": if(dy===0){dx=0; dy=20;} break;
    case "ArrowLeft": if(dx===0){dx=-20; dy=0;} break;
    case "ArrowRight": if(dx===0){dx=20; dy=0;} break;
  }
});

// Save score
function saveScore() {
  let scores = JSON.parse(localStorage.getItem("snakeScores")) || [];
  scores.push({user: currentUser, score});
  localStorage.setItem("snakeScores", JSON.stringify(scores));
}

// Show leaderboard
function showLeaderboard() {
  document.getElementById("controls").style.display = "none";
  canvas.style.display = "none";
  const scores = JSON.parse(localStorage.getItem("snakeScores")) || [];
  const scoresList = document.getElementById("scoresList");
  scoresList.innerHTML = "";

  scores.forEach((s,index)=>{
    const li = document.createElement("li");
    li.textContent = `${s.user} - ${s.score}`;
    
    if(isAdmin && s.user !== "Rudra") {
      const removeBtn = document.createElement("button");
      removeBtn.textContent = "âŒ Remove";
      removeBtn.onclick = ()=> removePlayer(index);
      li.appendChild(removeBtn);
    }

    scoresList.appendChild(li);
  });

  document.getElementById("leaderboard").style.display = "block";
}

// Remove player (admin only)
function removePlayer(index) {
  let scores = JSON.parse(localStorage.getItem("snakeScores")) || [];
  scores.splice(index,1);
  localStorage.setItem("snakeScores", JSON.stringify(scores));
  showLeaderboard();
}

// Restart game
function restartGame() {
  document.getElementById("controls").style.display = "block";
  document.getElementById("leaderboard").style.display = "none";
}
</script>
</body>
</html>
