<!DOCTYPE html>
<html>
<head>
    <title>Snake Game with Admin</title>
    <style>
        canvas {
            border: 2px solid black;
            background-color: #f0f0f0;
        }
        #controls button {
            margin: 5px;
            padding: 10px;
        }
        #message {
            font-weight: bold;
            margin: 10px 0;
            color: red;
        }
    </style>
</head>
<body>
    <h2>Snake Game</h2>
    <div id="loginDiv">
        Name: <input type="text" id="playerName">
        Password (if Rudra): <input type="password" id="passwordInput">
        <button id="enterBtn">Enter</button>
        <div id="loginMessage"></div>
    </div>
    <div id="gameDiv" style="display:none;">
        <canvas id="gameCanvas" width="400" height="400"></canvas>
        <div id="controls">
            <button id="upBtn">Up</button>
            <button id="downBtn">Down</button>
            <button id="leftBtn">Left</button>
            <button id="rightBtn">Right</button>
            <button id="pauseBtn">Pause</button>
            <button id="resumeBtn">Resume</button>
            <button id="retryBtn">Retry</button>
            <button id="soundBtn">Sound On/Off</button>
        </div>
        <div id="adminDiv" style="display:none;">
            <h3>Admin Panel</h3>
            <input type="text" id="removePlayerInput" placeholder="Enter player name to remove">
            <button id="removePlayerBtn">Remove Player</button>
            <div id="adminMsg"></div>
        </div>
        <div id="message"></div>
        <div>Score: <span id="score">0</span></div>
    </div>

    <script>
        let canvas = document.getElementById("gameCanvas");
        let ctx = canvas.getContext("2d");
        const grid = 20;
        let count = 0;
        let snake = [{x: 160, y: 160}];
        let dx = grid;
        let dy = 0;
        let food = {x: 0, y:0};
        let score = 0;
        let paused = false;
        let soundOn = true;

        // LocalStorage keys
        const storedPlayersKey = "snakePlayers";
        const removedPlayersKey = "removedPlayers";

        let players = JSON.parse(localStorage.getItem(storedPlayersKey)) || [];
        let removedPlayers = JSON.parse(localStorage.getItem(removedPlayersKey)) || [];
        let isAdmin = false;
        let currentPlayer = "";

        function randomFood() {
            food.x = Math.floor(Math.random() * 20) * grid;
            food.y = Math.floor(Math.random() * 20) * grid;
        }

        function draw() {
            if(paused) return;
            requestAnimationFrame(draw);
            if (++count < 4) return;
            count = 0;

            ctx.clearRect(0,0,canvas.width, canvas.height);

            // Snake
            ctx.fillStyle = "green";
            snake.forEach(function(part) {
                ctx.fillRect(part.x, part.y, grid-1, grid-1);
            });

            // Food
            ctx.fillStyle = "red";
            ctx.fillRect(food.x, food.y, grid-1, grid-1);

            // Move snake
            let head = {x: snake[0].x + dx, y: snake[0].y + dy};

            // Wall collision
            if(head.x < 0 || head.x >= canvas.width || head.y <0 || head.y >= canvas.height || snake.some(p => p.x===head.x && p.y===head.y)){
                alert("Game Over! Score: " + score);
                resetGame();
                return;
            }

            snake.unshift(head);

            // Food check
            if(head.x === food.x && head.y === food.y){
                score++;
                document.getElementById("score").innerText = score;
                randomFood();
            } else {
                snake.pop();
            }
        }

        function resetGame(){
            snake = [{x:160,y:160}];
            dx = grid;
            dy = 0;
            score = 0;
            document.getElementById("score").innerText = score;
            randomFood();
        }

        // Controls
        document.getElementById("upBtn").onclick = () => {if(dy===0){dx=0; dy=-grid;}};
        document.getElementById("downBtn").onclick = () => {if(dy===0){dx=0; dy=grid;}};
        document.getElementById("leftBtn").onclick = () => {if(dx===0){dx=-grid; dy=0;}};
        document.getElementById("rightBtn").onclick = () => {if(dx===0){dx=grid; dy=0;}};
        document.getElementById("pauseBtn").onclick = () => {paused=true;};
        document.getElementById("resumeBtn").onclick = () => {paused=false; draw();};
        document.getElementById("retryBtn").onclick = () => {resetGame();};
        document.getElementById("soundBtn").onclick = () => {soundOn = !soundOn; alert("Sound " + (soundOn?"On":"Off"));};

        // Login
        document.getElementById("enterBtn").onclick = () => {
            let name = document.getElementById("playerName").value.trim();
            let pass = document.getElementById("passwordInput").value;
            if(!name){
                document.getElementById("loginMessage").innerText = "Enter a valid name.";
                return;
            }

            if(removedPlayers.includes(name)){
                document.getElementById("loginMessage").innerText = "Admin has removed you. Use different name.";
                return;
            }

            if(players.includes(name)){
                document.getElementById("loginMessage").innerText = "Name already taken. Choose another.";
                return;
            }

            if(name==="Rudra"){
                if(pass!=="0108"){
                    document.getElementById("loginMessage").innerText = "Incorrect password for Rudra.";
                    return;
                }
                isAdmin = true;
                document.getElementById("adminDiv").style.display = "block";
            }

            currentPlayer = name;
            players.push(name);
            localStorage.setItem(storedPlayersKey, JSON.stringify(players));

            document.getElementById("loginDiv").style.display="none";
            document.getElementById("gameDiv").style.display="block";
            draw();
        }

        // Admin remove player
        document.getElementById("removePlayerBtn").onclick = () => {
            let remName = document.getElementById("removePlayerInput").value.trim();
            if(remName && players.includes(remName)){
                removedPlayers.push(remName);
                localStorage.setItem(removedPlayersKey, JSON.stringify(removedPlayers));
                players = players.filter(p => p !== remName);
                localStorage.setItem(storedPlayersKey, JSON.stringify(players));
                document.getElementById("adminMsg").innerText = remName + " has been removed by admin!";
            } else {
                document.getElementById("adminMsg").innerText = "Player not found.";
            }
        }

        // Keyboard arrows
        document.addEventListener("keydown", function(e){
            if(e.key==="ArrowUp" && dy===0){dx=0; dy=-grid;}
            if(e.key==="ArrowDown" && dy===0){dx=0; dy=grid;}
            if(e.key==="ArrowLeft" && dx===0){dx=-grid; dy=0;}
            if(e.key==="ArrowRight" && dx===0){dx=grid; dy=0;}
        });

        randomFood();
    </script>
</body>
</html>
