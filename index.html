<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Brick Breaker</title>
  <style>
    body {
      background: #111;
      color: #fff;
      font-family: Arial, sans-serif;
      text-align: center;
    }
    canvas {
      background: #000;
      display: block;
      margin: 10px auto;
      border: 2px solid white;
    }
    .controls {
      margin: 10px;
    }
    button {
      padding: 8px 15px;
      margin: 5px;
      border: none;
      border-radius: 5px;
      background: #ff6600;
      color: white;
      font-weight: bold;
      cursor: pointer;
    }
    button:hover { background: #ff8533; }
    .joystick {
      margin-top: 10px;
    }
    .joystick button {
      width: 60px;
    }
    #leaderboard {
      margin-top: 15px;
      background: #222;
      padding: 10px;
      border-radius: 5px;
      width: 250px;
      margin-left: auto;
      margin-right: auto;
    }
  </style>
</head>
<body>
  <h1>üî• Brick Breaker Game üî•</h1>
  <canvas id="gameCanvas" width="400" height="400"></canvas>

  <div class="controls">
    <button onclick="togglePause()">‚è∏ Pause</button>
    <button onclick="restartGame()">üîÑ Restart</button>
    <button onclick="retryLevel()">‚ôª Retry</button>
    <button onclick="toggleSound()">üîä Sound ON</button>
  </div>

  <div class="joystick">
    <button onclick="moveLeft()">‚¨Ö</button>
    <button onclick="moveRight()">‚û°</button>
  </div>

  <div id="leaderboard">
    <h3>üèÜ Leaderboard</h3>
    <ul id="leaderboardList"></ul>
  </div>

<script>
const canvas = document.getElementById("gameCanvas");
const ctx = canvas.getContext("2d");

let ballRadius = 8;
let x = canvas.width/2;
let y = canvas.height-30;
let dx = 2, dy = -2;

let paddleHeight = 10, paddleWidth = 75;
let paddleX = (canvas.width - paddleWidth) / 2;
let rightPressed = false, leftPressed = false;

let score = 0, lives = 3, level = 1;
let paused = false, soundOn = true;

const rows = 5, cols = 7;
const padding = 10, offsetTop = 30, offsetLeft = 30;
const brickHeight = 20;
let bricks = [];

function initBricks() {
  bricks = [];
  const totalPadding = (cols - 1) * padding;
  const brickWidth = (canvas.width - offsetLeft * 2 - totalPadding) / cols;

  for(let r=0;r<rows;r++) {
    bricks[r] = [];
    for(let c=0;c<cols;c++) {
      bricks[r][c] = { x: 0, y: 0, status: 1 };
    }
  }
  return brickWidth;
}

let brickWidth = initBricks();

document.addEventListener("keydown", keyDownHandler);
document.addEventListener("keyup", keyUpHandler);

function keyDownHandler(e) {
  if(e.key==="Right"||e.key==="ArrowRight") rightPressed = true;
  else if(e.key==="Left"||e.key==="ArrowLeft") leftPressed = true;
}
function keyUpHandler(e) {
  if(e.key==="Right"||e.key==="ArrowRight") rightPressed = false;
  else if(e.key==="Left"||e.key==="ArrowLeft") leftPressed = false;
}

function moveLeft(){ paddleX -= 30; }
function moveRight(){ paddleX += 30; }

function collisionDetection() {
  for(let r=0;r<rows;r++){
    for(let c=0;c<cols;c++){
      let b = bricks[r][c];
      if(b.status){
        if(x > b.x && x < b.x+brickWidth && y > b.y && y < b.y+brickHeight){
          dy = -dy; b.status=0;
          score++;
          if(score === rows*cols*level) {
            alert("üéâ Level " + level + " cleared!");
            level++;
            x=canvas.width/2; y=canvas.height-30; dx=2; dy=-2;
            paddleX=(canvas.width-paddleWidth)/2;
            brickWidth = initBricks();
          }
        }
      }
    }
  }
}

function drawBall() {
  ctx.beginPath();
  ctx.arc(x,y,ballRadius,0,Math.PI*2);
  ctx.fillStyle="red";
  ctx.fill(); ctx.closePath();
}

function drawPaddle() {
  ctx.beginPath();
  ctx.rect(paddleX,canvas.height-paddleHeight,paddleWidth,paddleHeight);
  ctx.fillStyle="blue";
  ctx.fill(); ctx.closePath();
}

function drawBricks() {
  for(let r=0;r<rows;r++){
    for(let c=0;c<cols;c++){
      if(bricks[r][c].status){
        let brickX = c*(brickWidth+padding)+offsetLeft;
        let brickY = r*(brickHeight+padding)+offsetTop;
        bricks[r][c].x=brickX; bricks[r][c].y=brickY;
        ctx.fillStyle="orange";
        ctx.fillRect(brickX,brickY,brickWidth,brickHeight);
      }
    }
  }
}

function drawScore() {
  ctx.font="16px Arial"; ctx.fillStyle="white";
  ctx.fillText("Score: "+score,8,20);
}
function drawLives() {
  ctx.font="16px Arial"; ctx.fillStyle="white";
  ctx.fillText("Lives: "+lives,canvas.width-65,20);
}
function drawLevel() {
  ctx.font="16px Arial"; ctx.fillStyle="white";
  ctx.fillText("Level: "+level,canvas.width/2-25,20);
}

function draw() {
  if(paused) return;
  ctx.clearRect(0,0,canvas.width,canvas.height);
  drawBricks(); drawBall(); drawPaddle();
  drawScore(); drawLives(); drawLevel();
  collisionDetection();

  if(x+dx>canvas.width-ballRadius||x+dx<ballRadius) dx=-dx;
  if(y+dy<ballRadius) dy=-dy;
  else if(y+dy>canvas.height-ballRadius){
    if(x>paddleX && x<paddleX+paddleWidth) dy=-dy;
    else{
      lives--;
      if(!lives){ 
        saveScore();
        alert("üíÄ Game Over");
        document.location.reload();
      } else {
        x=canvas.width/2; y=canvas.height-30; dx=2; dy=-2;
        paddleX=(canvas.width-paddleWidth)/2;
      }
    }
  }

  if(rightPressed && paddleX<canvas.width-paddleWidth) paddleX+=5;
  else if(leftPressed && paddleX>0) paddleX-=5;

  x+=dx; y+=dy;
  requestAnimationFrame(draw);
}

// Leaderboard
function saveScore(){
  let name=prompt("Enter your name:","Player");
  if(!name) name="Player";
  let leaderboard=JSON.parse(localStorage.getItem("leaderboard"))||[];
  leaderboard.push({name,score});
  leaderboard.sort((a,b)=>b.score-a.score);
  leaderboard=leaderboard.slice(0,5);
  localStorage.setItem("leaderboard",JSON.stringify(leaderboard));
  updateLeaderboard();
}
function updateLeaderboard(){
  let leaderboard=JSON.parse(localStorage.getItem("leaderboard"))||[];
  let list=document.getElementById("leaderboardList");
  list.innerHTML="";
  leaderboard.forEach(entry=>{
    let li=document.createElement("li");
    li.textContent=entry.name+" - "+entry.score;
    list.appendChild(li);
  });
}
updateLeaderboard();

// Controls
function togglePause(){ paused=!paused; if(!paused) draw(); }
function restartGame(){ document.location.reload(); }
function retryLevel(){
  x=canvas.width/2; y=canvas.height-30; dx=2; dy=-2;
  paddleX=(canvas.width-paddleWidth)/2;
  brickWidth = initBricks();
  score=0; lives=3; level=1;
}
function toggleSound(){ soundOn=!soundOn; alert("Sound "+(soundOn?"ON":"OFF")); }

draw();
</script>
</body>
</html>
